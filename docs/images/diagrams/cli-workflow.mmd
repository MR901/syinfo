graph TD
    %% SyInfo CLI Workflow - Updated Flags and Modules

    START["`**syinfo command**
    User runs CLI`"]

    PARSE["`**Argument Parser (argparse)**
    Parse flags and options`"]

    subgraph "Flag Detection"
        DEVICE_FLAG{"`**-d / --device?**
        Device info`"}
        NETWORK_FLAG{"`**-n / --network?**
        Network info`"}
        SYSTEM_FLAG{"`**-s / --system?**
        System info`"}
        SYS_MON_FLAG{"`**--system-monitor?**
        System monitoring`"}
        PROC_MON_FLAG{"`**--process-monitor?**
        Process monitoring`"}
        LOGS_FLAG{"`**-l / --logs?**
        Log analysis`"}
        PKG_FLAG{"`**-p / --packages?**
        Package inventory`"}
        SCAN_FLAG{"`**-N / --scan-network?**
        Network scan (sudo)`"}
    end

    subgraph "Data Collection"
        GET_DEVICE["`**DeviceInfo.get_all()**
        Collect hardware info`"]
        GET_NETWORK["`**NetworkInfo.get_all()**
        Network configuration`"]
        GET_SYSTEM["`**SystemInfo.get_all()**
        Combined device+network`"]
        START_SYS_MON["`**SystemMonitor**
        Start system monitor`"]
        START_PROC_MON["`**ProcessMonitor**
        Start process monitor`"]
        RUN_LOGS["`**LogAnalyzer**
        Query logs`"]
        RUN_PKGS["`**PackageManager**
        List packages`"]
        RUN_SCAN["`**search_devices_on_network**
        ARP scan (sudo)`"]
    end

    subgraph "Output Options"
        NOPRINT_FLAG{"`**--disable-print?**
        Disable formatted print`"}
        JSON_FLAG{"`**--json?**
        JSON output`"}
    end

    subgraph "Output Generation"
        TREE_OUTPUT["`**Tree Display**
        Formatted system tree`"]
        JSON_OUTPUT["`**JSON Output**
        Machine-readable data`"]
        SILENT["`**Silent Mode**
        No formatted output`"]
        MONITOR_DISPLAY["`**Monitor Summary**
        Performance metrics`"]
        MONITOR_JSON["`**Monitor JSON**
        Real-time data`"]
    end

    FINISH["`**Complete**
    Return exit code`"]

    %% Main Flow
    START --> PARSE
    PARSE --> DEVICE_FLAG
    PARSE --> NETWORK_FLAG
    PARSE --> SYSTEM_FLAG
    PARSE --> SYS_MON_FLAG
    PARSE --> PROC_MON_FLAG
    PARSE --> LOGS_FLAG
    PARSE --> PKG_FLAG
    PARSE --> SCAN_FLAG

    %% Collection Routes
    DEVICE_FLAG -->|Yes| GET_DEVICE
    NETWORK_FLAG -->|Yes| GET_NETWORK
    SYSTEM_FLAG -->|Yes| GET_SYSTEM
    SYS_MON_FLAG -->|Yes| START_SYS_MON
    PROC_MON_FLAG -->|Yes| START_PROC_MON
    LOGS_FLAG -->|Yes| RUN_LOGS
    PKG_FLAG -->|Yes| RUN_PKGS
    SCAN_FLAG -->|Yes| RUN_SCAN

    %% Output Decision Flow
    GET_DEVICE --> NOPRINT_FLAG
    GET_NETWORK --> NOPRINT_FLAG
    GET_SYSTEM --> NOPRINT_FLAG
    RUN_LOGS --> NOPRINT_FLAG
    RUN_PKGS --> NOPRINT_FLAG
    RUN_SCAN --> NOPRINT_FLAG
    START_SYS_MON --> NOPRINT_FLAG
    START_PROC_MON --> NOPRINT_FLAG

    NOPRINT_FLAG -->|No| JSON_FLAG
    NOPRINT_FLAG -->|Yes| JSON_FLAG

    %% Output Generation
    JSON_FLAG -->|No & Print=No| TREE_OUTPUT
    JSON_FLAG -->|Yes & Print=No| JSON_OUTPUT
    JSON_FLAG -->|No & Print=Yes| SILENT
    JSON_FLAG -->|Yes & Print=Yes| JSON_OUTPUT

    START_SYS_MON -->|Print=No & JSON=No| MONITOR_DISPLAY
    START_SYS_MON -->|JSON=Yes| MONITOR_JSON
    START_PROC_MON -->|Print=No & JSON=No| MONITOR_DISPLAY
    START_PROC_MON -->|JSON=Yes| MONITOR_JSON

    %% Completion
    TREE_OUTPUT --> FINISH
    JSON_OUTPUT --> FINISH
    SILENT --> FINISH
    MONITOR_DISPLAY --> FINISH
    MONITOR_JSON --> FINISH

    %% No flags case
    DEVICE_FLAG -->|No| NETWORK_FLAG
    NETWORK_FLAG -->|No| SYSTEM_FLAG
    SYSTEM_FLAG -->|No| SYS_MON_FLAG
    SYS_MON_FLAG -->|No| HELP["`**Show Help**
    Display usage info`"]
    HELP --> FINISH

    %% Styling
    classDef startEnd fill:#e8f5e8,stroke:#2e7d32,stroke-width:3px
    classDef decision fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef process fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef output fill:#fce4ec,stroke:#c2185b,stroke-width:2px

    class START,FINISH startEnd
    class DEVICE_FLAG,NETWORK_FLAG,SYSTEM_FLAG,SYS_MON_FLAG,PROC_MON_FLAG,LOGS_FLAG,PKG_FLAG,SCAN_FLAG,NOPRINT_FLAG,JSON_FLAG decision
    class PARSE,GET_DEVICE,GET_NETWORK,GET_SYSTEM,START_SYS_MON,START_PROC_MON,RUN_LOGS,RUN_PKGS,RUN_SCAN process
    class TREE_OUTPUT,JSON_OUTPUT,SILENT,MONITOR_DISPLAY,MONITOR_JSON,HELP output
